---
title: Trasformazioni di matrici
sidebar:
  order: 4
---

Three.js utilizza le `matrici` per codificare le trasformazioni 3D, traslazioni (posizione), rotazioni e ridimensionamento. Ogni istanza di [Object3D](api/core/Object3D)
ha una [matrice](api/core/Object3D#matrix) che memorizza la posizione, la rotazione e il ridimensionamento. Questa pagina descrive come aggiornare la trasformazione
di un oggetto.

## Proprietà di convenienza e `matrixAutoUpdate`

Ci sono due modi per aggiornare la trasformazione di un oggetto:

<ol>
<li>
Modificare le proprietà `position`, `quaternion` e `scale` dell'oggetto e lasciare che three.js ricalcoli la 
matrice dell'oggetto da queste proprietà:

```javascript
object.position.copy(start_position);
object.quaternion.copy(quaternion);
```

Per impostazione predefinita, la proprietà `matrixAutoUpdate` è impostata su true e la matrice viene ricalcolata automaticamente.
Se l'oggetto è statico, o desideri controllare manualmente quando avviene il ricalcolo, è possibile ottenere prestazioni migliori se la
proprietà è impostata a false.

```javascript
object.matrixAutoUpdate = false;
```

E dopo aver modificato le proprietà, aggiornare manualmente la matrice:

```javascript
object.updateMatrix();
```

</li>
<li>
Modificare direttamente la matrice dell'oggetto. La classe [Matrix4](api/math/Matrix4) possiede vari metodi per modificare la matrice:

```javascript
object.matrix.setRotationFromQuaternion(quaternion);
object.matrix.setPosition(start_position);
object.matrixAutoUpdate = false;
```

Nota che, in questo caso, `matrixAutoUpdate` _deve_ essere impostata a `false`, e devi essere sicuro di _non_ chiamare `updateMatrix`.
La chiamata di `updateMatrix` eliminerà le modifiche manuali apportate alla matrice, ricalcolando la matrice da `position`, `scale`, e così via.

</li>
</ol>

## Oggetto e matrici del mondo (world matrices)

La [matrice](api/core/Object3D#matrix) dell'oggetto memorizza la trsformazione dell'oggetto _relativa_ al [genitore](api/core/Object3D#parent) dell'oggetto:
per ottenere la trasformazione dell'oggetto nelle coordinate del _mondo_, è necessario accedere alla [Object3D](api/core/Object3D#matrixWorld) dell'oggetto.

Quando la trasformazione dell'oggetto padre o dell'oggetto figlio cambia, puoi richiedere che la [matrixWorld](api/core/Object3D#matrixWorld) dell'oggetto
figlio venga aggiornata chiamando il metodo [updateMatrixWorld](api/core/Object3D#updateMatrixWorld)().

## Rotazione e Quaternione

Three.js fornisce due modi per rappresentare le rotazioni 3D: [angoli di Eulero](api/math/Euler) e [Quaternioni](api/math/Quaternion),
nonché metodi per la conversione tra i due. Gli angoli di Eulero sono soggetti ad un problema chiamato "gimbal lock", in cui alcune
configurazioni possono perdere un grado di libertà (impedendo all'oggetto di essere ruotato su un asse). Per questo motivo, le
rotazioni degli oggetti sono _sempre_ memorizzate nei [quaternioni](api/core/Object3D#quaternion) dell'oggetto.

Le versioni precedenti della libreria includevano una proprietà `useQuaternion` che, se impostata a false, faceva si che la
[matrix](api/core/Object3D#matrix) dell'oggetto fosse calcolata da un angolo di Eulero. Questa pratica è deprecata, si deve invece
usare il metodo [setRotationFromEuler](api/core/Object3D#setRotationFromEuler), il quale aggiornerà il quaternione.
